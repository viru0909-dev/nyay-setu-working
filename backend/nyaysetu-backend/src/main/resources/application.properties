# Server Configuration
server.port=8080
# Removed context-path - endpoints are already prefixed with /api in controllers
# server.servlet.context-path=/api

# Application Name
spring.application.name=nyaysetu-backend

# Database Configuration (Local/Development)
spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/nyaysetu}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver

# PgBouncer Compatibility (Supabase Transaction Pooler)
# Disables driver-side prepared statements to prevent "prepared statement already exists" errors
spring.datasource.hikari.data-source-properties.prepareThreshold=0
spring.datasource.hikari.data-source-properties.binaryTransfer=false
spring.datasource.hikari.data-source-properties.cancelSignalTimeout=0
spring.datasource.hikari.data-source-properties.tcpKeepAlive=true

# JPA Configuration
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=${SHOW_SQL:false}
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true


# Flyway Migration - Production Ready
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.validate-on-migrate=false
spring.flyway.ignore-missing-migrations=true
# Use a separate connection for Flyway (Direct Connection) to avoid Transaction Pooler issues
# Defaults to normal datasource if not specified (e.g. locally)
spring.flyway.url=${FLYWAY_URL:jdbc:postgresql://aws-1-ap-south-1.pooler.supabase.com:6543/postgres?sslmode=require}
spring.flyway.user=${FLYWAY_USER:${spring.datasource.username}}
spring.flyway.password=${FLYWAY_PASSWORD:${spring.datasource.password}}

# JWT Configuration
jwt.secret=${JWT_SECRET:nyaysetu-2024-secure-jwt-signing-key-minimum-256-bits-required}
jwt.expiration=${JWT_EXPIRATION_MS:86400000}

# CORS Configuration
# Ensure no trailing slashes in your environment variables if possible, though Spring usually handles it
cors.allowed.origins=${CORS_ALLOWED_ORIGINS:http://localhost:5173,http://localhost:3000}

# File Upload Configuration
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=50MB
spring.servlet.multipart.max-request-size=50MB

# Google Gemini AI Configuration (NOT USED - Using local fake AI instead)
# gemini.api.key=${GEMINI_API_KEY:}
gemini.model=gemini-1.5-flash

# File Storage
file.upload-dir=uploads

# SMTP Configuration (for email verification)
spring.mail.host=${SMTP_HOST:smtp.gmail.com}
spring.mail.port=${SMTP_PORT:587}
spring.mail.username=${SMTP_USERNAME:}
spring.mail.password=${SMTP_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# Frontend Configuration
app.frontend.url=${FRONTEND_URL:http://localhost:5173}
app.password-reset.token-validity=1800000

# AI Service Configuration (Google Gemini)
gemini.api.key=${GEMINI_API_KEY:}
openai.api.key=${OPENAI_API_KEY:your-openai-api-key-here}

# Ollama Configuration (Local AI)
ollama.base.url=${OLLAMA_BASE_URL:http://localhost:11434}
ollama.model=${OLLAMA_MODEL:gemma3:1b}
ai.provider=${AI_PROVIDER:ollama}

# Actuator Configuration
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=always

# Logging
logging.level.com.nyaysetu=INFO
logging.level.org.springframework.security=DEBUG

# ============================================
# AZURE AI CONFIGURATION (Vakil-Friend System)
# ============================================

# Azure OpenAI Configuration for Chat-First Filing
azure.openai.endpoint=${AZURE_OPENAI_ENDPOINT:https://uaenorth.api.cognitive.microsoft.com/}
azure.openai.api.key=${AZURE_OPENAI_API_KEY:}
azure.openai.deployment.name=${AZURE_OPENAI_DEPLOYMENT:nyay-gpt}

# Azure Document Intelligence for Evidence Verification
azure.document.intelligence.api.key=${AZURE_DOCUMENT_INTELLIGENCE_KEY:}
azure.document.intelligence.endpoint=${AZURE_DOCUMENT_INTELLIGENCE_ENDPOINT:}

# Chat Session Configuration
chat.session.timeout.minutes=30
chat.max.messages.per.session=100

# ============================================
# GROQ AI CONFIGURATION (Free, Fast Llama API)
# ============================================
# Get your free API key at: https://console.groq.com
groq.api.key=${GROQ_API_KEY:}
groq.model=llama-3.1-8b-instant

